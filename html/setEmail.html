<template class="task-template">
    <div id='setEmailHtml' class="html">
        <div class="jusCenter inbox-emall" style="width:960px;">
            <div>
                <p>
                    <img class="newAccountBtnImg" src="./assets/img/emailLogo.png">
                </p>
                <p class="nomail">您当前没有绑定的邮箱</p>
                <p class="jusCenter"><button class="newAccountBtn">New Account</button></p>
            </div>
        </div>
        <!--modal-->
        <!-- <div class="max-modal"></div>
        <div class="newAccountDiv" style="display: none;">
            <div class="newAccountHead">New Account</div>
            <section>
                <div class="newAccount">
                    <div class="newAccountList">
                        <i class="ia"><img rel='QQMailbox' src="./assets/img/mails/email_icon_qqmailbox.png"></i>
                        <i class="ib">QQMailbox</i>
                    </div>
                    <div class="newAccountList">
                        <i class="ia"><img rel='QQMail' src="./assets/img/mails/email_icon_qq.png"></i>
                        <i class="ib">QQMail</i>
                    </div>
                    <div class="newAccountList">
                        <i class="ia"><img rel='163Mail' src="./assets/img/mails/email_icon_163.png"></i>
                        <i class="ib">163Mail</i>
                    </div>
                    <div class="newAccountList">
                        <i class="ia"><img rel='Gmail' src="./assets/img/mails/email_icon_google.png"></i>
                        <i class="ib">Gmail</i>
                    </div>
                    <div class="newAccountList">
                        <i class="ia"><img rel='Outlook' src="./assets/img/mails/email_icon_outlook.png"></i>
                        <i class="ib">Outlook, Hotmail, live</i>
                    </div>
                    <div class="newAccountList">
                        <i class="ia"><img rel='iCloud' src="./assets/img/mails/email_icon_icloud.png"></i>
                        <i class="ib">iCloud</i>
                    </div>
                    <div class="newAccountList">
                        <i class="ia"><img rel='Other' src="./assets/img/mails/email_icon_other.png"></i>
                        <i class="ib">Other (IMAP)</i>
                    </div>
                    <div class="newAccountFooter">
                        <button class="newAccountCancel">Cancel</button>
                    </div>
                </div>
            </section>
        </div>
        modal
        <div class="mailLogin" style="display: none;margin-left:-110px;">
            <form action="" onsubmit="return false">
                <header>
                    <img id='mailLoginImg' src="./assets/img/mails/email_icon_163_n.png">
                </header>
                <section>

                    <p class="mailLoginTitle">Email</p>
                    <p><input class="mailLoginInput" type="email" autofocus="autofocus" placeholder="example@gmail.com">
                    </p>
                    <p class="mailLoginTitle">Password</p>
                    <p><input class="mailLoginInput" type="password" pattern='.{6,20}'
                            placeholder="Password/Authorization code"></p>
                </section>
                <footer>
                    <button class="mailLoginBtn">Login</button>
                </footer>
            </form>
        </div>
    </div> -->



    <script>
        

        $(function () {
            const settings = require('electron-settings');
            $(document).on('click','.newAccountBtn,.newAccountBtnImg,.New-Account',function(){
                $('.newAccountDiv,.max-modal').show()
            })
         
            $('.newAccountCancel').click(function () {
                $('.newAccountDiv,.max-modal').hide()
            })
            $('.newAccountList').hover(function () {
                $(this).css({ 'background': "#6646F7", 'color': '#fff' })
            }, function () {
                $(this).css({ 'background': "#fff", 'color': '#000' })
            })
            let rel = ''
            $('.newAccountList').click(function () {
                let _this = $(this)
                let val = _this.find('.ib').text()
                let img = _this.find('.ia img').attr('src')
                img = img.replace('.png', '_n.png')
                rel = _this.find('.ia img').attr('rel')
                $('#mailLoginImg').attr('src', img)
                $('.newAccountDiv').hide()
                $('.mailLogin,.max-modal').show().attr('rel',rel)
            })

            $('.mailLoginBtn').click(function () {
              
                console.log(Math.ceil(Math.random()*10))
                let $mailLoginInput = $('.mailLoginInput')
                let Email = $mailLoginInput.eq(0).val()
                let Password = $mailLoginInput.eq(1).val()
                let rel = $('.mailLogin').attr('rel')
               
                let host = getHost(rel)

                if (Email && Password) {
                    debugger;
                let lastImap = settings.get('IMAP')  
                if(!lastImap){
                    try {
                      getMail({ Email, Password, host })
                    } catch (error) {
                       console.log(error)
                    }
                }else if (lastImap.Email !== Email) {
                    
                   
                    try {
                      getMail({ Email, Password, host })
                    } catch (error) {
                       console.log(error)
                    }
                    $('.myEmail').text(Email)
                } else {
                    // try {
                    //   getMail({ Email, Password, host })
                    // } catch (error) {
                    //    console.log(error)
                    // }
                    console.log('mailLoginBtn click,请忽重复配置邮箱')
                }

                hideInbox('setEmailHtmlLogin')
            }

            })
        })
       
    </script>
</template>